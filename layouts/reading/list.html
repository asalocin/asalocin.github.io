{{ define "main" }}
  <h1>{{ .Title }}</h1>
  {{ .Content }}

  {{ $pages := .Pages }}

  <!-- NOW -->
  <h2 id="now">📖 Currently Reading</h2>
  {{ $now := where $pages "Params.status" "now" }}
  {{ if gt (len $now) 0 }}
    <ul>
      {{ range $now }}
        <li>
          <a href="{{ .RelPermalink }}"><strong>{{ .Title }}</strong></a>
          {{ with .Params.author }} — {{ . }}{{ end }}
          {{ with .Params.progress }} · {{ . }}%{{ end }}
          {{ with .Params.summary }} · <em>{{ . }}</em>{{ end }}
        </li>
      {{ end }}
    </ul>
  {{ else }}
    <p><em>Nothing open right now.</em></p>
  {{ end }}

  <!-- FINISHED -->
  <h2 id="finished">✅ Finished</h2>
  {{ $fin := where $pages "Params.status" "finished" }}
  {{ if gt (len $fin) 0 }}
    <ul>
      {{ range sort $fin "Params.rating" "desc" }}
        <li>
          <a href="{{ .RelPermalink }}"><strong>{{ .Title }}</strong></a>
          {{ with .Params.author }} — {{ . }}{{ end }}
          {{ with .Params.rating }} · {{ strings.Repeat . "⭐" }}{{ end }}
          {{ with .Params.finished }} · <time>{{ . }}</time>{{ end }}
          {{ with .Params.summary }}<br><em>{{ . }}</em>{{ end }}
        </li>
      {{ end }}
    </ul>
  {{ else }}
    <p><em>No finished books yet.</em></p>
  {{ end }}

  <!-- QUEUE -->
  <h2 id="queue">🕮 To Read</h2>
  {{ $queue := where $pages "Params.status" "queue" }}
  {{ if gt (len $queue) 0 }}
    <ul>
      {{ range $queue }}
        <li>
          <a href="{{ .RelPermalink }}"><strong>{{ .Title }}</strong></a>
          {{ with .Params.author }} — {{ . }}{{ end }}
          {{ with .Params.summary }} · <em>{{ . }}</em>{{ end }}
        </li>
      {{ end }}
    </ul>
  {{ else }}
    <p><em>Queue is empty.</em></p>
  {{ end }}

  <!-- TAGS -->
  <h2 id="tags">🏷️ Tags</h2>
  {{ with .Site.Taxonomies.tags }}
    <p>
      {{ range $tag, $pp := . }}
        <a href="{{ "/tags/" | relLangURL }}{{ $tag | urlize }}/">#{{ $tag }}</a> ({{ len $pp }}) ·
      {{ end }}
    </p>
  {{ end }}
{{ end }}
